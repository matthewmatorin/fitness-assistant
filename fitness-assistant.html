<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Fitness Assistant</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        /* Navigation */
        .nav-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav {
            display: flex;
            justify-content: center;
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 50px;
            padding: 8px;
        }

        .nav-item {
            flex: 1;
            text-align: center;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-item.active {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Quick Actions Section */
        .quick-actions {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .quick-actions h2 {
            margin-bottom: 1.5rem;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .action-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 1.5rem;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1rem;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .action-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .action-btn i {
            font-size: 1.5rem;
        }

        /* Summary Cards */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .summary-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.15);
        }

        .summary-card h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1rem;
            color: #333;
        }

        .summary-card .stat {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        .summary-card .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            animation: modalFadeIn 0.3s ease;
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #333;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
        }

        /* Button Styles */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #e1e5e9;
        }

        .btn-secondary:hover {
            background: #e9ecef;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }

        /* Chart Tabs */
        .chart-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 8px;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }

        .chart-tab {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .chart-tab:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .chart-tab.active {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        /* Chart Containers */
        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            display: none;
        }

        .chart-container.active-chart {
            display: block;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .chart-header h3 {
            color: #333;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
            width: 100%;
        }

        .chart-wrapper canvas {
            max-height: 100%;
            width: 100% !important;
        }

        /* Improved Chart Filters */
        .chart-filters {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 16px;
            border: 2px solid #e1e5e9;
            background: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
            color: #666;
        }

        .filter-btn:hover {
            border-color: #667eea;
            color: #667eea;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        /* Enhanced ChatGPT Styles */
        .chatgpt-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 0;
            margin-top: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }

        .chat-header h3 {
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .chat-header p {
            opacity: 0.9;
            margin: 0;
        }

        .chat-messages {
            max-height: 400px;
            overflow-y: auto;
            padding: 1rem;
            background: #f8f9fa;
        }

        .chat-message {
            display: flex;
            gap: 12px;
            margin-bottom: 1.5rem;
            animation: messageSlideIn 0.3s ease;
        }

        @keyframes messageSlideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .ai-message .message-avatar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .user-message .message-avatar {
            background: #e9ecef;
            color: #666;
        }

        .message-content {
            flex: 1;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 18px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .user-message .message-content {
            background: #667eea;
            color: white;
        }

        .suggestion-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 1rem;
        }

        .suggestion-chip {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 20px;
            padding: 8px 12px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .suggestion-chip:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .chat-input-container {
            padding: 1.5rem;
            background: white;
            border-top: 1px solid #e9ecef;
        }

        .chat-input {
            display: flex;
            gap: 12px;
            margin-bottom: 1rem;
        }

        .chat-input input {
            flex: 1;
            padding: 12px 18px;
            border: 2px solid #e1e5e9;
            border-radius: 25px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .chat-input input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .chat-input button {
            width: 48px;
            height: 48px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-input button:hover {
            background: #5a6fd8;
            transform: scale(1.05);
        }

        .chat-input button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .chat-settings {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: #666;
        }

        .chat-settings input[type="checkbox"] {
            width: auto;
        }

        /* Loading indicator for chat */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 1rem;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* Insights Stats Improvements */
        .insights-stats .stats-grid {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .stat-value {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 8px;
            line-height: 1;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
            font-weight: 500;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 350px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: #dc3545;
        }

        .notification.warning {
            background: #ffc107;
            color: #333;
        }

        /* Settings Styles */
        .settings-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        .export-controls {
            display: flex;
            gap: 15px;
            align-items: end;
            flex-wrap: wrap;
        }

        .export-controls .form-group {
            margin-bottom: 0;
            min-width: 150px;
        }

        /* Data Table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e1e5e9;
        }

        .data-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #555;
        }

        .data-table tbody tr:hover {
            background: #f8f9fa;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .nav {
                margin: 0 1rem;
            }

            .nav-item {
                padding: 10px;
                font-size: 0.9rem;
            }

            .nav-item span {
                display: none;
            }

            .action-buttons {
                grid-template-columns: 1fr;
            }

            .summary-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                padding: 1.5rem;
            }

            .chart-header {
                flex-direction: column;
                align-items: stretch;
            }

            .chart-filters {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <div class="nav-container">
        <div class="nav">
            <div class="nav-item active" onclick="showTab('dashboard')">
                <i class="fas fa-home"></i>
                <span>Dashboard</span>
            </div>
            <div class="nav-item" onclick="showTab('insights')">
                <i class="fas fa-chart-line"></i>
                <span>Insights</span>
            </div>
            <div class="nav-item" onclick="showTab('settings')">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <!-- Quick Actions -->
            <div class="quick-actions">
                <h2><i class="fas fa-bolt"></i> Quick Actions</h2>
                <div class="action-buttons">
                    <button class="action-btn" onclick="openModal('workoutModal')">
                        <i class="fas fa-dumbbell"></i>
                        Log Workout
                    </button>
                    <button class="action-btn" onclick="openModal('weightModal')">
                        <i class="fas fa-weight"></i>
                        Log Weight
                    </button>
                    <button class="action-btn" onclick="openModal('birthdayModal')">
                        <i class="fas fa-birthday-cake"></i>
                        Add Birthday
                    </button>
                </div>
            </div>

            <!-- Summary Cards -->
            <div class="summary-grid">
                <div class="summary-card" onclick="openModal('workoutDetailModal')">
                    <h3><i class="fas fa-dumbbell"></i> Workouts</h3>
                    <div class="stat" id="weeklyWorkouts">-</div>
                    <div class="stat-label">This Week</div>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        Avg: <span id="avgWorkouts">-</span>/week | 
                        <span id="workoutTrend">-</span> vs last week
                    </div>
                </div>

                <div class="summary-card" onclick="openModal('weightDetailModal')">
                    <h3><i class="fas fa-weight"></i> Weight</h3>
                    <div class="stat" id="currentWeight">-</div>
                    <div class="stat-label">Current Weight</div>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        Lost: <span id="totalWeightLoss">-</span> lbs total
                    </div>
                </div>

                <div class="summary-card" onclick="openModal('birthdayDetailModal')">
                    <h3><i class="fas fa-birthday-cake"></i> Birthdays</h3>
                    <div class="stat" id="weeklyBirthdays">-</div>
                    <div class="stat-label">This Week</div>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        This Month: <span id="monthlyBirthdays">-</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Insights Tab -->
        <div id="insights" class="tab-content">
            <!-- Stats Overview -->
            <div class="insights-stats">
                <div class="stats-grid" style="margin-bottom: 2rem;">
                    <div class="stat-card">
                        <div class="stat-value" id="insightCurrentWeight">-</div>
                        <div class="stat-label">Current Weight</div>
                        <div style="font-size: 0.8rem; margin-top: 5px; opacity: 0.9;" id="weightTrendText">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="insightTotalWorkouts">-</div>
                        <div class="stat-label">Total Workouts</div>
                        <div style="font-size: 0.8rem; margin-top: 5px; opacity: 0.9;" id="workoutStreakText">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="insightWeeklyAvg">-</div>
                        <div class="stat-label">Weekly Average</div>
                        <div style="font-size: 0.8rem; margin-top: 5px; opacity: 0.9;">workouts per week</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="insightFavoriteType">-</div>
                        <div class="stat-label">Favorite Workout</div>
                        <div style="font-size: 0.8rem; margin-top: 5px; opacity: 0.9;" id="favoriteTypeCount">-</div>
                    </div>
                </div>
            </div>

            <!-- Chart Selection Tabs -->
            <div class="chart-tabs">
                <button class="chart-tab active" onclick="showChart('weight')">
                    <i class="fas fa-weight"></i> Weight Progress
                </button>
                <button class="chart-tab" onclick="showChart('workouts')">
                    <i class="fas fa-dumbbell"></i> Workout Analysis
                </button>
                <button class="chart-tab" onclick="showChart('trends')">
                    <i class="fas fa-chart-line"></i> Weekly Trends
                </button>
            </div>

            <!-- Weight Chart Container -->
            <div id="weightChartContainer" class="chart-container active-chart">
                <div class="chart-header">
                    <h3><i class="fas fa-weight"></i> Weight Progress</h3>
                    <div class="chart-filters">
                        <button class="filter-btn active" onclick="filterWeightChart(7)" data-period="7">7 Days</button>
                        <button class="filter-btn" onclick="filterWeightChart(14)" data-period="14">14 Days</button>
                        <button class="filter-btn" onclick="filterWeightChart(30)" data-period="30">30 Days</button>
                        <button class="filter-btn" onclick="filterWeightChart(

                        <button class="filter-btn" onclick="filterWeightChart(60)" data-period="60">60 Days</button>
                        <button class="filter-btn" onclick="filterWeightChart('all')" data-period="all">All Time</button>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="weightChart"></canvas>
                </div>
            </div>

            <!-- Workout Chart Container -->
            <div id="workoutChartContainer" class="chart-container">
                <div class="chart-header">
                    <h3><i class="fas fa-dumbbell"></i> Workout Analysis</h3>
                    <div class="chart-filters">
                        <button class="filter-btn active" onclick="showWorkoutChart('types')" data-type="types">By Type</button>
                        <button class="filter-btn" onclick="showWorkoutChart('duration')" data-type="duration">Duration Trends</button>
                        <button class="filter-btn" onclick="showWorkoutChart('frequency')" data-type="frequency">Frequency</button>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="workoutChart"></canvas>
                </div>
            </div>

            <!-- Trends Chart Container -->
            <div id="trendsChartContainer" class="chart-container">
                <div class="chart-header">
                    <h3><i class="fas fa-chart-line"></i> Weekly Trends</h3>
                    <div class="chart-filters">
                        <button class="filter-btn active" onclick="showTrendsChart('workout-frequency')" data-trend="workout-frequency">Workout Frequency</button>
                        <button class="filter-btn" onclick="showTrendsChart('weight-change')" data-trend="weight-change">Weight Changes</button>
                        <button class="filter-btn" onclick="showTrendsChart('combined')" data-trend="combined">Combined View</button>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="trendsChart"></canvas>
                </div>
            </div>

            <!-- ChatGPT Integration -->
            <div class="chatgpt-container">
                <div class="chat-header">
                    <h3><i class="fas fa-robot"></i> AI Fitness Coach</h3>
                    <p>Ask questions about your data and get personalized insights powered by ChatGPT</p>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <div class="chat-message ai-message">
                        <div class="message-avatar">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="message-content">
                            <p>Hi! I'm your AI fitness coach. I can analyze your workout and weight data to provide personalized insights. Try asking:</p>
                            <div class="suggestion-chips">
                                <button class="suggestion-chip" onclick="askSuggestion('How is my weight loss progress this month?')">
                                    Weight progress this month
                                </button>
                                <button class="suggestion-chip" onclick="askSuggestion('What workout type should I focus on?')">
                                    Workout recommendations
                                </button>
                                <button class="suggestion-chip" onclick="askSuggestion('Am I meeting my fitness goals?')">
                                    Goal assessment
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chat-input-container">
                    <div class="chat-input">
                        <input type="text" id="chatInput" placeholder="Ask about your fitness progress..." onkeypress="handleChatKeyPress(event)">
                        <button onclick="askChatGPT()" id="chatSendBtn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                    <div class="chat-settings">
                        <label>
                            <input type="checkbox" id="includePersonalData" checked>
                            Include my personal data in analysis
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="settings-section">
                <h3><i class="fas fa-download"></i> Export Data</h3>
                <div class="export-controls">
                    <div class="form-group">
                        <label>Data Type</label>
                        <select id="exportDataType">
                            <option value="workouts">Workouts</option>
                            <option value="weight">Weight</option>
                            <option value="birthdays">Birthdays</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Format</label>
                        <select id="exportFormat">
                            <option value="csv">CSV</option>
                            <option value="excel">Excel</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="exportData()">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>

            <div class="settings-section">
                <h3><i class="fas fa-bell"></i> Notifications</h3>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="emailNotifications" checked>
                        Enable weekly email summaries
                    </label>
                </div>
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="notificationEmail" placeholder="your@email.com">
                </div>
                <button class="btn btn-primary" onclick="saveNotificationSettings()">
                    <i class="fas fa-save"></i> Save Settings
                </button>
            </div>

            <div class="settings-section">
                <h3><i class="fas fa-upload"></i> Import Data</h3>
                <p style="color: #666; margin-bottom: 1rem;">Upload your CSV files to import historical data.</p>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <label class="btn btn-secondary" style="cursor: pointer;">
                        <i class="fas fa-dumbbell"></i> Import Workouts
                        <input type="file" accept=".csv" onchange="importCSV(event, 'workouts')" style="display: none;">
                    </label>
                    <label class="btn btn-secondary" style="cursor: pointer;">
                        <i class="fas fa-weight"></i> Import Weight
                        <input type="file" accept=".csv" onchange="importCSV(event, 'weight')" style="display: none;">
                    </label>
                    <label class="btn btn-secondary" style="cursor: pointer;">
                        <i class="fas fa-birthday-cake"></i> Import Birthdays
                        <input type="file" accept=".csv" onchange="importCSV(event, 'birthdays')" style="display: none;">
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Workout Modal -->
    <div id="workoutModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-dumbbell"></i> Log Workout</h3>
                <button class="close-btn" onclick="closeModal('workoutModal')">&times;</button>
            </div>
            <form id="workoutForm">
                <div class="form-group">
                    <label>Date *</label>
                    <input type="date" id="workoutDate" required>
                </div>
                <div class="form-group">
                    <label>Workout Type *</label>
                    <select id="workoutType" required onchange="toggleWorkoutFields()">
                        <option value="">Select type...</option>
                        <option value="walk">Walk</option>
                        <option value="lift">Lift</option>
                        <option value="run">Run</option>
                        <option value="tennis">Tennis</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group" id="durationGroup" style="display: none;">
                    <label>Duration (minutes) *</label>
                    <input type="number" id="workoutDuration" min="1">
                </div>
                <div class="form-group" id="distanceGroup" style="display: none;">
                    <label>Distance (miles) *</label>
                    <input type="number" id="workoutDistance" step="0.1" min="0.1">
                </div>
                <div class="form-group" id="hrZoneGroup" style="display: none;">
                    <label>HR Zone *</label>
                    <select id="workoutHRZone">
                        <option value="">Select zone...</option>
                        <option value="1">Zone 1 (50-60% max HR)</option>
                        <option value="2">Zone 2 (60-70% max HR)</option>
                        <option value="3">Zone 3 (70-80% max HR)</option>
                        <option value="4">Zone 4 (80-90% max HR)</option>
                        <option value="5">Zone 5 (90-100% max HR)</option>
                    </select>
                </div>
                <div class="form-group" id="muscleGroupsGroup" style="display: none;">
                    <label>Muscle Groups *</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="chest" value="chest">
                            <label for="chest">Chest</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="biceps" value="biceps">
                            <label for="biceps">Biceps</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="core" value="core">
                            <label for="core">Core</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="pushups" value="pushups">
                            <label for="pushups">Push-ups</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="shoulders" value="shoulders">
                            <label for="shoulders">Shoulders</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="back" value="back">
                            <label for="back">Back</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="legs" value="legs">
                            <label for="legs">Legs</label>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="workoutNotes" rows="3" placeholder="How did it feel?"></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('workoutModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Workout
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Weight Modal -->
    <div id="weightModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-weight"></i> Log Weight</h3>
                <button class="close-btn" onclick="closeModal('weightModal')">&times;</button>
            </div>
            <form id="weightForm">
                <div class="form-group">
                    <label>Date *</label>
                    <input type="date" id="weightDate" required>
                </div>
                <div class="form-group">
                    <label>Weight (lbs) *</label>
                    <input type="number" id="weightValue" step="0.1" min="1" required>
                </div>
                <div class="form-group">
                    <label>Body Fat % (optional)</label>
                    <input type="number" id="bodyFatValue" step="0.1" min="0" max="100">
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="weightNotes" rows="2" placeholder="Morning weight, after workout, etc."></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('weightModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Weight
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Birthday Modal -->
    <div id="birthdayModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-birthday-cake"></i> Add Birthday</h3>
                <button class="close-btn" onclick="closeModal('birthdayModal')">&times;</button>
            </div>
            <form id="birthdayForm">
                <div class="form-group">
                    <label>Name *</label>
                    <input type="text" id="birthdayName" required placeholder="Enter name">
                </div>
                <div class="form-group">
                    <label>Date *</label>
                    <input type="date" id="birthdayDate" required>
                </div>
                <div class="form-group">
                    <label>Age</label>
                    <input type="number" id="birthdayAge" min="0" placeholder="Current age">
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="birthdayNotes" rows="3" placeholder="Gift ideas, relationship, etc."></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('birthdayModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Birthday
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Detail Modals -->
    <!-- Workout Detail Modal -->
    <div id="workoutDetailModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3><i class="fas fa-dumbbell"></i> Recent Workouts</h3>
                <button class="close-btn" onclick="closeModal('workoutDetailModal')">&times;</button>
            </div>
            <div id="workoutDetailContent">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Duration</th>
                            <th>Distance</th>
                            <th>HR Zone</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody id="workoutDetailBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Weight Detail Modal -->
    <div id="weightDetailModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3><i class="fas fa-weight"></i> Weight Progress</h3>
                <button class="close-btn" onclick="closeModal('weightDetailModal')">&times;</button>
            </div>
            <div class="chart-filters" style="margin-bottom: 1rem;">
                <button class="filter-btn active" onclick="filterModalWeightChart(7)">7 Days</button>
                <button class="filter-btn" onclick="filterModalWeightChart(14)">14 Days</button>
                <button class="filter-btn" onclick="filterModalWeightChart(30)">30 Days</button>
                <button class="filter-btn" onclick="filterModalWeightChart(60)">60 Days</button>
                <button class="filter-btn" onclick="filterModalWeightChart('all')">All Time</button>
            </div>
            <canvas id="modalWeightChart" width="400" height="300"></canvas>
        </div>
    </div>

    <!-- Birthday Detail Modal -->
    <div id="birthdayDetailModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3><i class="fas fa-birthday-cake"></i> This Month's Birthdays</h3>
                <button class="close-btn" onclick="closeModal('birthdayDetailModal')">&times;</button>
            </div>
            <div id="birthdayDetailContent"></div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <i class="fas fa-check-circle"></i>
        <span></span>
    </div>

    <script>
        // Global data storage
        let appData = {
            workouts: [],
            weight: [],
            birthdays: []
        };

        // Global charts
        let weightChart = null;
        let workoutChart = null;
        let modalWeightChart = null;

        // Chart Management
        let currentChart = 'weight';
        let currentWeightPeriod = 7;
        let currentWorkoutView = 'types';
        let currentTrendsView = 'workout-frequency';

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            setDefaultDates();
            setupEventListeners();
            loadSampleData(); // Remove this when you have real data
            updateDashboard();
            updateInsights();
        }

        function setDefaultDates() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('workoutDate').value = today;
            document.getElementById('weightDate').value = today;
        }

        function setupEventListeners() {
            // Form submissions
            document.getElementById('workoutForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveWorkout();
            });

            document.getElementById('weightForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveWeight();
            });

            document.getElementById('birthdayForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveBirthday();
            });

            // Close modals on background click
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closeModal(modal.id);
                    }
                });
            });
        }

        // Tab Management
        function showTab(tabName) {
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');

            // Update content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');

            // Update insights if switching to insights tab
            if (tabName === 'insights') {
                setTimeout(updateInsights, 100);
            }
        }

        // Modal Management
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('show');
            
            // Special handling for detail modals
            if (modalId === 'workoutDetailModal') {
                loadWorkoutDetails();
            } else if (modalId === 'weightDetailModal') {
                loadWeightDetails();
            } else if (modalId === 'birthdayDetailModal') {
                loadBirthdayDetails();
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        // Workout Functions
        function toggleWorkoutFields() {
            const type = document.getElementById('workoutType').value;
            
            // Hide all conditional fields
            document.getElementById('durationGroup').style.display = 'none';
            document.getElementById('distanceGroup').style.display = 'none';
            document.getElementById('hrZoneGroup').style.display = 'none';
            document.getElementById('muscleGroupsGroup').style.display = 'none';

            // Clear required attributes
            document.getElementById('workoutDuration').required = false;
            document.getElementById('workoutDistance').required = false;
            document.getElementById('workoutHRZone').required = false;

            // Show relevant fields based on type
            if (type === 'walk') {
                document.getElementById('durationGroup').style.display = 'block';
                document.getElementById('hrZoneGroup').style.display = 'block';
                document.getElementById('workoutDuration').required = true;
                document.getElementById('workoutHRZone').required = true;
            } else if (type === 'run') {
                document.getElementById('distanceGroup').style.display = 'block';
                document.getElementById('workoutDistance').required = true;
            } else if (type === 'lift') {
                document.getElementById('muscleGroupsGroup').style.display = 'block';
            }
        }

        function saveWorkout() {
            const workout = {
                id: Date.now(),
                Date: document.getElementById('workoutDate').value,
                Type: document.getElementById('workoutType').value,
                Duration: document.getElementById('workoutDuration').value || '',
                Distance: parseFloat(document.getElementById('workoutDistance').value) || null,
                'HR Zone': parseFloat(document.getElementById('workoutHRZone').value) || null,
                Notes: document.getElementById('workoutNotes').value || ''
            };

            // Add muscle groups for lifting
            if (workout.Type === 'lift') {
                const muscleGroups = [];
                document.querySelectorAll('#muscleGroupsGroup input[type="checkbox"]:checked').forEach(checkbox => {
                    muscleGroups.push(checkbox.value);
                });
                if (muscleGroups.length === 0) {
                    showNotification('Please select at least one muscle group for lifting workouts', 'error');
                    return;
                }
                workout.Notes = workout.Notes + (workout.Notes ? ' | ' : '') + 'Muscle Groups: ' + muscleGroups.join(', ');
            }

            appData.workouts.push(workout);
            closeModal('workoutModal');
            document.getElementById('workoutForm').reset();
            setDefaultDates();
            updateDashboard();
            showNotification('Workout logged successfully!');
        }

        function saveWeight() {
            const weight = {
                id: Date.now(),
                Date: document.getElementById('weightDate').value,
                Weight: parseFloat(document.getElementById('weightValue').value),
                'Body Fat %': parseFloat(document.getElementById('bodyFatValue').value) || null,
                Notes: document.getElementById('weightNotes').value || ''
            };

            appData.weight.push(weight);
            closeModal('weightModal');
            document.getElementById('weightForm').reset();
            setDefaultDates();
            updateDashboard();
            updateInsights();
            showNotification('Weight logged successfully!');
        }

        function saveBirthday() {
            const birthday = {
                id: Date.now(),
                Name: document.getElementById('birthdayName').value,
                Date: document.getElementById('birthdayDate').value,
                Age: parseInt(document.getElementById('birthdayAge').value) || null,
                Notes: document.getElementById('birthdayNotes').value || ''
            };

            appData.birthdays.push(birthday);
            closeModal('birthdayModal');
            document.getElementById('birthdayForm').reset();
            updateDashboard();
            showNotification('Birthday added successfully!');
        }

        // Dashboard Updates
        function updateDashboard() {
            updateWorkoutStats();
            updateWeightStats();
            updateBirthdayStats();
        }

        function updateWorkoutStats() {
            const now = new Date();
            const startOfWeek = new Date(now.setDate(now.getDate() - now.getDay() + 1)); // Monday
            const endOfWeek = new Date(startOfWeek);
            endOfWeek.setDate(endOfWeek.getDate() + 6); // Sunday

            const thisWeekWorkouts = appData.workouts.filter(workout => {
                const workoutDate = new Date(workout.Date);
                return workoutDate >= startOfWeek && workoutDate <= endOfWeek;
            }).length;

            // Calculate weekly average
            const totalWeeks = Math.max(1, Math.ceil(appData.workouts.length / 7));
            const avgWorkouts = (appData.workouts.length / totalWeeks).toFixed(1);

            // Calculate last week for comparison
            const lastWeekStart = new Date(startOfWeek);
            lastWeekStart.setDate(lastWeekStart.getDate() - 7);
            const lastWeekEnd = new Date(endOfWeek);
            lastWeekEnd.setDate(lastWeekEnd.getDate() - 7);

            const lastWeekWorkouts = appData.workouts.filter(workout => {
                const workoutDate = new Date(workout.Date);
                return workoutDate >= lastWeekStart && workoutDate <= lastWeekEnd;
            }).length;

            const trend = thisWeekWorkouts - lastWeekWorkouts;
            const trendText = trend > 0 ? `+${trend}` : trend.toString();

            document.getElementById('weeklyWorkouts').textContent = thisWeekWorkouts;
            document.getElementById('avgWorkouts').textContent = avgWorkouts;
            document.getElementById('workoutTrend').textContent = trendText;
        }

        function updateWeightStats() {
            if (appData.weight.length === 0) {
                document.getElementById('currentWeight').textContent = '-';
                document.getElementById('totalWeightLoss').textContent = '-';
                return;
            }

            const sortedWeights = appData.weight.sort((a, b) => new Date(b.Date) - new Date(a.Date));
            const currentWeight = sortedWeights[0].Weight;
            const maxWeight = Math.max(...appData.weight.map(w => w.Weight));
            const totalLoss = (maxWeight - currentWeight).toFixed(1);

            document.getElementById('currentWeight').textContent = currentWeight + ' lbs';
            document.getElementById('totalWeightLoss').textContent = totalLoss;
        }

        function updateBirthdayStats() {
            const now = new Date();
            const startOfWeek = new Date(now.setDate(now.getDate() - now.getDay() + 1));
            const endOfWeek = new Date(startOfWeek);
            endOfWeek.setDate(endOfWeek.getDate() + 6);

            const thisWeekBirthdays = appData.birthdays.filter(birthday => {
                const birthDate = new Date(birthday.Date);
                const thisYearBirthday = new Date(now.getFullYear(), birthDate.getMonth(), birthDate.getDate());
                return thisYearBirthday >= startOfWeek && thisYearBirthday <= endOfWeek;
            }).length;

            const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);
            const endOfMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0);

            const thisMonthBirthdays = appData.birthdays.filter(birthday => {
                const birthDate = new Date(birthday.Date);
                const thisYearBirthday = new Date(now.getFullYear(), birthDate.getMonth(), birthDate.getDate());
                return thisYearBirthday >= startOfMonth && thisYearBirthday <= endOfMonth;
            }).length;

            document.getElementById('weeklyBirthdays').textContent = thisWeekBirthdays;
            document.getElementById('monthlyBirthdays').textContent = thisMonthBirthdays;
        }

        // Chart Functions
        function showChart(chartType) {
            // Update tab buttons
            document.querySelectorAll('.chart-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Update chart containers
            document.querySelectorAll('.chart-container').forEach(container => {
                container.classList.remove('active-chart');
            });
            document.getElementById(`${chartType}ChartContainer`).classList.add('active-chart');

            currentChart = chartType;

            // Load appropriate chart
            setTimeout(() => {
                if (chartType === 'weight') {
                    updateWeightChart();
                } else if (chartType === 'workouts') {
                    updateWorkoutChart();
                } else if (chartType === 'trends') {
                    updateTrendsChart();
                }
            }, 100);
        }

        function updateInsights() {
            updateInsightsStats();
            setTimeout(() => {
                updateWeightChart();
                updateWorkoutChart();
                updateTrendsChart();
            }, 100);
        }

        function updateInsightsStats() {
            // Current weight
            if (appData.weight.length > 0) {
                const sortedWeights = appData.weight.sort((a, b) => new Date(b.Date) - new Date(a.Date));
                const currentWeight = sortedWeights[0].Weight;
                const firstWeight = appData.weight.sort((a, b) => new Date(a.Date) - new Date(b.Date))[0].Weight;
                const weightChange = currentWeight - firstWeight;
                
                document.getElementById('insightCurrentWeight').textContent = currentWeight + ' lbs';
                document.getElementById('weightTrendText').textContent = 
                    weightChange < 0 ? `▼ ${Math.abs(weightChange).toFixed(1)} lbs lost` : 
                    weightChange > 0 ? `▲ ${weightChange.toFixed(1)} lbs gained` : 'No change';
            }

            // Total workouts
            document.getElementById('insightTotalWorkouts').textContent = appData.workouts.length;
            
            // Weekly average
            if (appData.workouts.length > 0) {
                const sortedWorkouts = appData.workouts.sort((a, b) => new Date(a.Date) - new Date(b.Date));
                const firstDate = new Date(sortedWorkouts[0].Date);
                const lastDate = new Date(sortedWorkouts[sortedWorkouts.length - 1].Date);
                const daysDiff = (lastDate - firstDate) / (1000 * 60 * 60 * 24);
                const weeks = Math.max(1, daysDiff / 7);
                const weeklyAvg = (appData.workouts.length / weeks).toFixed(1);
                <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Fitness Assistant</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        /* Navigation */
        .nav-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav {
            display: flex;
            justify-content: center;
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 50px;
            padding: 8px;
        }

        .nav-item {
            flex: 1;
            text-align: center;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-item.active {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Quick Actions Section */
        .quick-actions {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .quick-actions h2 {
            margin-bottom: 1.5rem;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .action-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 1.5rem;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1rem;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .action-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .action-btn i {
            font-size: 1.5rem;
        }

        /* Summary Cards */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .summary-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.15);
        }

        .summary-card h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1rem;
            color: #333;
        }

        .summary-card .stat {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        .summary-card .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            animation: modalFadeIn 0.3s ease;
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #333;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
        }

        /* Button Styles */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #e1e5e9;
        }

        .btn-secondary:hover {
            background: #e9ecef;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }

        /* Chart Tabs */
        .chart-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 8px;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }

        .chart-tab {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .chart-tab:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .chart-tab.active {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        /* Chart Containers */
        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            display: none;
        }

        .chart-container.active-chart {
            display: block;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .chart-header h3 {
            color: #333;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
            width: 100%;
        }

        .chart-wrapper canvas {
            max-height: 100%;
            width: 100% !important;
        }

        /* Improved Chart Filters */
        .chart-filters {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 16px;
            border: 2px solid #e1e5e9;
            background: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
            color: #666;
        }

        .filter-btn:hover {
            border-color: #667eea;
            color: #667eea;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        /* Enhanced ChatGPT Styles */
        .chatgpt-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 0;
            margin-top: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }

        .chat-header h3 {
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .chat-header p {
            opacity: 0.9;
            margin: 0;
        }

        .chat-messages {
            max-height: 400px;
            overflow-y: auto;
            padding: 1rem;
            background: #f8f9fa;
        }

        .chat-message {
            display: flex;
            gap: 12px;
            margin-bottom: 1.5rem;
            animation: messageSlideIn 0.3s ease;
        }

        @keyframes messageSlideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .ai-message .message-avatar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .user-message .message-avatar {
            background: #e9ecef;
            color: #666;
        }

        .message-content {
            flex: 1;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 18px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .user-message .message-content {
            background: #667eea;
            color: white;
        }

        .suggestion-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 1rem;
        }

        .suggestion-chip {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 20px;
            padding: 8px 12px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .suggestion-chip:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .chat-input-container {
            padding: 1.5rem;
            background: white;
            border-top: 1px solid #e9ecef;
        }

        .chat-input {
            display: flex;
            gap: 12px;
            margin-bottom: 1rem;
        }

        .chat-input input {
            flex: 1;
            padding: 12px 18px;
            border: 2px solid #e1e5e9;
            border-radius: 25px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .chat-input input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .chat-input button {
            width: 48px;
            height: 48px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-input button:hover {
            background: #5a6fd8;
            transform: scale(1.05);
        }

        .chat-input button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .chat-settings {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: #666;
        }

        .chat-settings input[type="checkbox"] {
            width: auto;
        }

        /* Loading indicator for chat */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 1rem;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* Insights Stats Improvements */
        .insights-stats .stats-grid {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .stat-value {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 8px;
            line-height: 1;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
            font-weight: 500;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 350px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: #dc3545;
        }

        .notification.warning {
            background: #ffc107;
            color: #333;
        }

        /* Settings Styles */
        .settings-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        .export-controls {
            display: flex;
            gap: 15px;
            align-items: end;
            flex-wrap: wrap;
        }

        .export-controls .form-group {
            margin-bottom: 0;
            min-width: 150px;
        }

        /* Data Table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e1e5e9;
        }

        .data-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #555;
        }

        .data-table tbody tr:hover {
            background: #f8f9fa;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .nav {
                margin: 0 1rem;
            }

            .nav-item {
                padding: 10px;
                font-size: 0.9rem;
            }

            .nav-item span {
                display: none;
            }

            .action-buttons {
                grid-template-columns: 1fr;
            }

            .summary-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                padding: 1.5rem;
            }

            .chart-header {
                flex-direction: column;
                align-items: stretch;
            }

            .chart-filters {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <div class="nav-container">
        <div class="nav">
            <div class="nav-item active" onclick="showTab('dashboard')">
                <i class="fas fa-home"></i>
                <span>Dashboard</span>
            </div>
            <div class="nav-item" onclick="showTab('insights')">
                <i class="fas fa-chart-line"></i>
                <span>Insights</span>
            </div>
            <div class="nav-item" onclick="showTab('settings')">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <!-- Quick Actions -->
            <div class="quick-actions">
                <h2><i class="fas fa-bolt"></i> Quick Actions</h2>
                <div class="action-buttons">
                    <button class="action-btn" onclick="openModal('workoutModal')">
                        <i class="fas fa-dumbbell"></i>
                        Log Workout
                    </button>
                    <button class="action-btn" onclick="openModal('weightModal')">
                        <i class="fas fa-weight"></i>
                        Log Weight
                    </button>
                    <button class="action-btn" onclick="openModal('birthdayModal')">
                        <i class="fas fa-birthday-cake"></i>
                        Add Birthday
                    </button>
                </div>
            </div>

            <!-- Summary Cards -->
            <div class="summary-grid">
                <div class="summary-card" onclick="openModal('workoutDetailModal')">
                    <h3><i class="fas fa-dumbbell"></i> Workouts</h3>
                    <div class="stat" id="weeklyWorkouts">-</div>
                    <div class="stat-label">This Week</div>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        Avg: <span id="avgWorkouts">-</span>/week | 
                        <span id="workoutTrend">-</span> vs last week
                    </div>
                </div>

                <div class="summary-card" onclick="openModal('weightDetailModal')">
                    <h3><i class="fas fa-weight"></i> Weight</h3>
                    <div class="stat" id="currentWeight">-</div>
                    <div class="stat-label">Current Weight</div>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        Lost: <span id="totalWeightLoss">-</span> lbs total
                    </div>
                </div>

                <div class="summary-card" onclick="openModal('birthdayDetailModal')">
                    <h3><i class="fas fa-birthday-cake"></i> Birthdays</h3>
                    <div class="stat" id="weeklyBirthdays">-</div>
                    <div class="stat-label">This Week</div>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        This Month: <span id="monthlyBirthdays">-</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Insights Tab -->
        <div id="insights" class="tab-content">
            <!-- Stats Overview -->
            <div class="insights-stats">
                <div class="stats-grid" style="margin-bottom: 2rem;">
                    <div class="stat-card">
                        <div class="stat-value" id="insightCurrentWeight">-</div>
                        <div class="stat-label">Current Weight</div>
                        <div style="font-size: 0.8rem; margin-top: 5px; opacity: 0.9;" id="weightTrendText">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="insightTotalWorkouts">-</div>
                        <div class="stat-label">Total Workouts</div>
                        <div style="font-size: 0.8rem; margin-top: 5px; opacity: 0.9;" id="workoutStreakText">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="insightWeeklyAvg">-</div>
                        <div class="stat-label">Weekly Average</div>
                        <div style="font-size: 0.8rem; margin-top: 5px; opacity: 0.9;">workouts per week</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="insightFavoriteType">-</div>
                        <div class="stat-label">Favorite Workout</div>
                        <div style="font-size: 0.8rem; margin-top: 5px; opacity: 0.9;" id="favoriteTypeCount">-</div>
                    </div>
                </div>
            </div>

            <!-- Chart Selection Tabs -->
            <div class="chart-tabs">
                <button class="chart-tab active" onclick="showChart('weight')">
                    <i class="fas fa-weight"></i> Weight Progress
                </button>
                <button class="chart-tab" onclick="showChart('workouts')">
                    <i class="fas fa-dumbbell"></i> Workout Analysis
                </button>
                <button class="chart-tab" onclick="showChart('trends')">
                    <i class="fas fa-chart-line"></i> Weekly Trends
                </button>
            </div>

            <!-- Weight Chart Container -->
            <div id="weightChartContainer" class="chart-container active-chart">
                <div class="chart-header">
                    <h3><i class="fas fa-weight"></i> Weight Progress</h3>
                    <div class="chart-filters">
                        <button class="filter-btn active" onclick="filterWeightChart(7)" data-period="7">7 Days</button>
                        <button class="filter-btn" onclick="filterWeightChart(14)" data-period="14">14 Days</button>
                        <button class="filter-btn" onclick="filterWeightChart(30)" data-period="30">30 Days</button>
                        <button class="filter-btn" onclick="filterWeightChart(

                        <button class="filter-btn" onclick="filterWeightChart(60)" data-period="60">60 Days</button>
                        <button class="filter-btn" onclick="filterWeightChart('all')" data-period="all">All Time</button>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="weightChart"></canvas>
                </div>
            </div>

            <!-- Workout Chart Container -->
            <div id="workoutChartContainer" class="chart-container">
                <div class="chart-header">
                    <h3><i class="fas fa-dumbbell"></i> Workout Analysis</h3>
                    <div class="chart-filters">
                        <button class="filter-btn active" onclick="showWorkoutChart('types')" data-type="types">By Type</button>
                        <button class="filter-btn" onclick="showWorkoutChart('duration')" data-type="duration">Duration Trends</button>
                        <button class="filter-btn" onclick="showWorkoutChart('frequency')" data-type="frequency">Frequency</button>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="workoutChart"></canvas>
                </div>
            </div>

            <!-- Trends Chart Container -->
            <div id="trendsChartContainer" class="chart-container">
                <div class="chart-header">
                    <h3><i class="fas fa-chart-line"></i> Weekly Trends</h3>
                    <div class="chart-filters">
                        <button class="filter-btn active" onclick="showTrendsChart('workout-frequency')" data-trend="workout-frequency">Workout Frequency</button>
                        <button class="filter-btn" onclick="showTrendsChart('weight-change')" data-trend="weight-change">Weight Changes</button>
                        <button class="filter-btn" onclick="showTrendsChart('combined')" data-trend="combined">Combined View</button>
                    </div>
                </div>
                <div class="chart-wrapper">
                    <canvas id="trendsChart"></canvas>
                </div>
            </div>

            <!-- ChatGPT Integration -->
            <div class="chatgpt-container">
                <div class="chat-header">
                    <h3><i class="fas fa-robot"></i> AI Fitness Coach</h3>
                    <p>Ask questions about your data and get personalized insights powered by ChatGPT</p>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <div class="chat-message ai-message">
                        <div class="message-avatar">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="message-content">
                            <p>Hi! I'm your AI fitness coach. I can analyze your workout and weight data to provide personalized insights. Try asking:</p>
                            <div class="suggestion-chips">
                                <button class="suggestion-chip" onclick="askSuggestion('How is my weight loss progress this month?')">
                                    Weight progress this month
                                </button>
                                <button class="suggestion-chip" onclick="askSuggestion('What workout type should I focus on?')">
                                    Workout recommendations
                                </button>
                                <button class="suggestion-chip" onclick="askSuggestion('Am I meeting my fitness goals?')">
                                    Goal assessment
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="chat-input-container">
                    <div class="chat-input">
                        <input type="text" id="chatInput" placeholder="Ask about your fitness progress..." onkeypress="handleChatKeyPress(event)">
                        <button onclick="askChatGPT()" id="chatSendBtn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                    <div class="chat-settings">
                        <label>
                            <input type="checkbox" id="includePersonalData" checked>
                            Include my personal data in analysis
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="settings-section">
                <h3><i class="fas fa-download"></i> Export Data</h3>
                <div class="export-controls">
                    <div class="form-group">
                        <label>Data Type</label>
                        <select id="exportDataType">
                            <option value="workouts">Workouts</option>
                            <option value="weight">Weight</option>
                            <option value="birthdays">Birthdays</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Format</label>
                        <select id="exportFormat">
                            <option value="csv">CSV</option>
                            <option value="excel">Excel</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="exportData()">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>

            <div class="settings-section">
                <h3><i class="fas fa-bell"></i> Notifications</h3>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="emailNotifications" checked>
                        Enable weekly email summaries
                    </label>
                </div>
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="notificationEmail" placeholder="your@email.com">
                </div>
                <button class="btn btn-primary" onclick="saveNotificationSettings()">
                    <i class="fas fa-save"></i> Save Settings
                </button>
            </div>

            <div class="settings-section">
                <h3><i class="fas fa-upload"></i> Import Data</h3>
                <p style="color: #666; margin-bottom: 1rem;">Upload your CSV files to import historical data.</p>
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <label class="btn btn-secondary" style="cursor: pointer;">
                        <i class="fas fa-dumbbell"></i> Import Workouts
                        <input type="file" accept=".csv" onchange="importCSV(event, 'workouts')" style="display: none;">
                    </label>
                    <label class="btn btn-secondary" style="cursor: pointer;">
                        <i class="fas fa-weight"></i> Import Weight
                        <input type="file" accept=".csv" onchange="importCSV(event, 'weight')" style="display: none;">
                    </label>
                    <label class="btn btn-secondary" style="cursor: pointer;">
                        <i class="fas fa-birthday-cake"></i> Import Birthdays
                        <input type="file" accept=".csv" onchange="importCSV(event, 'birthdays')" style="display: none;">
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Workout Modal -->
    <div id="workoutModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-dumbbell"></i> Log Workout</h3>
                <button class="close-btn" onclick="closeModal('workoutModal')">&times;</button>
            </div>
            <form id="workoutForm">
                <div class="form-group">
                    <label>Date *</label>
                    <input type="date" id="workoutDate" required>
                </div>
                <div class="form-group">
                    <label>Workout Type *</label>
                    <select id="workoutType" required onchange="toggleWorkoutFields()">
                        <option value="">Select type...</option>
                        <option value="walk">Walk</option>
                        <option value="lift">Lift</option>
                        <option value="run">Run</option>
                        <option value="tennis">Tennis</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group" id="durationGroup" style="display: none;">
                    <label>Duration (minutes) *</label>
                    <input type="number" id="workoutDuration" min="1">
                </div>
                <div class="form-group" id="distanceGroup" style="display: none;">
                    <label>Distance (miles) *</label>
                    <input type="number" id="workoutDistance" step="0.1" min="0.1">
                </div>
                <div class="form-group" id="hrZoneGroup" style="display: none;">
                    <label>HR Zone *</label>
                    <select id="workoutHRZone">
                        <option value="">Select zone...</option>
                        <option value="1">Zone 1 (50-60% max HR)</option>
                        <option value="2">Zone 2 (60-70% max HR)</option>
                        <option value="3">Zone 3 (70-80% max HR)</option>
                        <option value="4">Zone 4 (80-90% max HR)</option>
                        <option value="5">Zone 5 (90-100% max HR)</option>
                    </select>
                </div>
                <div class="form-group" id="muscleGroupsGroup" style="display: none;">
                    <label>Muscle Groups *</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="chest" value="chest">
                            <label for="chest">Chest</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="biceps" value="biceps">
                            <label for="biceps">Biceps</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="core" value="core">
                            <label for="core">Core</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="pushups" value="pushups">
                            <label for="pushups">Push-ups</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="shoulders" value="shoulders">
                            <label for="shoulders">Shoulders</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="back" value="back">
                            <label for="back">Back</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="legs" value="legs">
                            <label for="legs">Legs</label>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="workoutNotes" rows="3" placeholder="How did it feel?"></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('workoutModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Workout
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Weight Modal -->
    <div id="weightModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-weight"></i> Log Weight</h3>
                <button class="close-btn" onclick="closeModal('weightModal')">&times;</button>
            </div>
            <form id="weightForm">
                <div class="form-group">
                    <label>Date *</label>
                    <input type="date" id="weightDate" required>
                </div>
                <div class="form-group">
                    <label>Weight (lbs) *</label>
                    <input type="number" id="weightValue" step="0.1" min="1" required>
                </div>
                <div class="form-group">
                    <label>Body Fat % (optional)</label>
                    <input type="number" id="bodyFatValue" step="0.1" min="0" max="100">
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="weightNotes" rows="2" placeholder="Morning weight, after workout, etc."></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('weightModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Weight
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Birthday Modal -->
    <div id="birthdayModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-birthday-cake"></i> Add Birthday</h3>
                <button class="close-btn" onclick="closeModal('birthdayModal')">&times;</button>
            </div>
            <form id="birthdayForm">
                <div class="form-group">
                    <label>Name *</label>
                    <input type="text" id="birthdayName" required placeholder="Enter name">
                </div>
                <div class="form-group">
                    <label>Date *</label>
                    <input type="date" id="birthdayDate" required>
                </div>
                <div class="form-group">
                    <label>Age</label>
                    <input type="number" id="birthdayAge" min="0" placeholder="Current age">
                </div>
                <div class="form-group">
                    <label>Notes</label>
                    <textarea id="birthdayNotes" rows="3" placeholder="Gift ideas, relationship, etc."></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('birthdayModal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Birthday
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Detail Modals -->
    <!-- Workout Detail Modal -->
    <div id="workoutDetailModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3><i class="fas fa-dumbbell"></i> Recent Workouts</h3>
                <button class="close-btn" onclick="closeModal('workoutDetailModal')">&times;</button>
            </div>
            <div id="workoutDetailContent">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Type</th>
                            <th>Duration</th>
                            <th>Distance</th>
                            <th>HR Zone</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody id="workoutDetailBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Weight Detail Modal -->
    <div id="weightDetailModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3><i class="fas fa-weight"></i> Weight Progress</h3>
                <button class="close-btn" onclick="closeModal('weightDetailModal')">&times;</button>
            </div>
            <div class="chart-filters" style="margin-bottom: 1rem;">
                <button class="filter-btn active" onclick="filterModalWeightChart(7)">7 Days</button>
                <button class="filter-btn" onclick="filterModalWeightChart(14)">14 Days</button>
                <button class="filter-btn" onclick="filterModalWeightChart(30)">30 Days</button>
                <button class="filter-btn" onclick="filterModalWeightChart(60)">60 Days</button>
                <button class="filter-btn" onclick="filterModalWeightChart('all')">All Time</button>
            </div>
            <canvas id="modalWeightChart" width="400" height="300"></canvas>
        </div>
    </div>

    <!-- Birthday Detail Modal -->
    <div id="birthdayDetailModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3><i class="fas fa-birthday-cake"></i> This Month's Birthdays</h3>
                <button class="close-btn" onclick="closeModal('birthdayDetailModal')">&times;</button>
            </div>
            <div id="birthdayDetailContent"></div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <i class="fas fa-check-circle"></i>
        <span></span>
    </div>

    <script>
        // Global data storage
        let appData = {
            workouts: [],
            weight: [],
            birthdays: []
        };

        // Global charts
        let weightChart = null;
        let workoutChart = null;
        let modalWeightChart = null;

        // Chart Management
        let currentChart = 'weight';
        let currentWeightPeriod = 7;
        let currentWorkoutView = 'types';
        let currentTrendsView = 'workout-frequency';

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            setDefaultDates();
            setupEventListeners();
            loadSampleData(); // Remove this when you have real data
            updateDashboard();
            updateInsights();
        }

        function setDefaultDates() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('workoutDate').value = today;
            document.getElementById('weightDate').value = today;
        }

        function setupEventListeners() {
            // Form submissions
            document.getElementById('workoutForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveWorkout();
            });

            document.getElementById('weightForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveWeight();
            });

            document.getElementById('birthdayForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveBirthday();
            });

            // Close modals on background click
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closeModal(modal.id);
                    }
                });
            });
        }

        // Tab Management
        function showTab(tabName) {
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');

            // Update content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');

            // Update insights if switching to insights tab
            if (tabName === 'insights') {
                setTimeout(updateInsights, 100);
            }
        }

        // Modal Management
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('show');
            
            // Special handling for detail modals
            if (modalId === 'workoutDetailModal') {
                loadWorkoutDetails();
            } else if (modalId === 'weightDetailModal') {
                loadWeightDetails();
            } else if (modalId === 'birthdayDetailModal') {
                loadBirthdayDetails();
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        // Workout Functions
        function toggleWorkoutFields() {
            const type = document.getElementById('workoutType').value;
            
            // Hide all conditional fields
            document.getElementById('durationGroup').style.display = 'none';
            document.getElementById('distanceGroup').style.display = 'none';
            document.getElementById('hrZoneGroup').style.display = 'none';
            document.getElementById('muscleGroupsGroup').style.display = 'none';

            // Clear required attributes
            document.getElementById('workoutDuration').required = false;
            document.getElementById('workoutDistance').required = false;
            document.getElementById('workoutHRZone').required = false;

            // Show relevant fields based on type
            if (type === 'walk') {
                document.getElementById('durationGroup').style.display = 'block';
                document.getElementById('hrZoneGroup').style.display = 'block';
                document.getElementById('workoutDuration').required = true;
                document.getElementById('workoutHRZone').required = true;
            } else if (type === 'run') {
                document.getElementById('distanceGroup').style.display = 'block';
                document.getElementById('workoutDistance').required = true;
            } else if (type === 'lift') {
                document.getElementById('muscleGroupsGroup').style.display = 'block';
            }
        }

        function saveWorkout() {
            const workout = {
                id: Date.now(),
                Date: document.getElementById('workoutDate').value,
                Type: document.getElementById('workoutType').value,
                Duration: document.getElementById('workoutDuration').value || '',
                Distance: parseFloat(document.getElementById('workoutDistance').value) || null,
                'HR Zone': parseFloat(document.getElementById('workoutHRZone').value) || null,
                Notes: document.getElementById('workoutNotes').value || ''
            };

            // Add muscle groups for lifting
            if (workout.Type === 'lift') {
                const muscleGroups = [];
                document.querySelectorAll('#muscleGroupsGroup input[type="checkbox"]:checked').forEach(checkbox => {
                    muscleGroups.push(checkbox.value);
                });
                if (muscleGroups.length === 0) {
                    showNotification('Please select at least one muscle group for lifting workouts', 'error');
                    return;
                }
                workout.Notes = workout.Notes + (workout.Notes ? ' | ' : '') + 'Muscle Groups: ' + muscleGroups.join(', ');
            }

            appData.workouts.push(workout);
            closeModal('workoutModal');
            document.getElementById('workoutForm').reset();
            setDefaultDates();
            updateDashboard();
            showNotification('Workout logged successfully!');
        }

        function saveWeight() {
            const weight = {
                id: Date.now(),
                Date: document.getElementById('weightDate').value,
                Weight: parseFloat(document.getElementById('weightValue').value),
                'Body Fat %': parseFloat(document.getElementById('bodyFatValue').value) || null,
                Notes: document.getElementById('weightNotes').value || ''
            };

            appData.weight.push(weight);
            closeModal('weightModal');
            document.getElementById('weightForm').reset();
            setDefaultDates();
            updateDashboard();
            updateInsights();
            showNotification('Weight logged successfully!');
        }

        function saveBirthday() {
            const birthday = {
                id: Date.now(),
                Name: document.getElementById('birthdayName').value,
                Date: document.getElementById('birthdayDate').value,
                Age: parseInt(document.getElementById('birthdayAge').value) || null,
                Notes: document.getElementById('birthdayNotes').value || ''
            };

            appData.birthdays.push(birthday);
            closeModal('birthdayModal');
            document.getElementById('birthdayForm').reset();
            updateDashboard();
            showNotification('Birthday added successfully!');
        }

        // Dashboard Updates
        function updateDashboard() {
            updateWorkoutStats();
            updateWeightStats();
            updateBirthdayStats();
        }

        function updateWorkoutStats() {
            const now = new Date();
            const startOfWeek = new Date(now.setDate(now.getDate() - now.getDay() + 1)); // Monday
            const endOfWeek = new Date(startOfWeek);
            endOfWeek.setDate(endOfWeek.getDate() + 6); // Sunday

            const thisWeekWorkouts = appData.workouts.filter(workout => {
                const workoutDate = new Date(workout.Date);
                return workoutDate >= startOfWeek && workoutDate <= endOfWeek;
            }).length;

            // Calculate weekly average
            const totalWeeks = Math.max(1, Math.ceil(appData.workouts.length / 7));
            const avgWorkouts = (appData.workouts.length / totalWeeks).toFixed(1);

            // Calculate last week for comparison
            const lastWeekStart = new Date(startOfWeek);
            lastWeekStart.setDate(lastWeekStart.getDate() - 7);
            const lastWeekEnd = new Date(endOfWeek);
            lastWeekEnd.setDate(lastWeekEnd.getDate() - 7);

            const lastWeekWorkouts = appData.workouts.filter(workout => {
                const workoutDate = new Date(workout.Date);
                return workoutDate >= lastWeekStart && workoutDate <= lastWeekEnd;
            }).length;

            const trend = thisWeekWorkouts - lastWeekWorkouts;
            const trendText = trend > 0 ? `+${trend}` : trend.toString();

            document.getElementById('weeklyWorkouts').textContent = thisWeekWorkouts;
            document.getElementById('avgWorkouts').textContent = avgWorkouts;
            document.getElementById('workoutTrend').textContent = trendText;
        }

        function updateWeightStats() {
            if (appData.weight.length === 0) {
                document.getElementById('currentWeight').textContent = '-';
                document.getElementById('totalWeightLoss').textContent = '-';
                return;
            }

            const sortedWeights = appData.weight.sort((a, b) => new Date(b.Date) - new Date(a.Date));
            const currentWeight = sortedWeights[0].Weight;
            const maxWeight = Math.max(...appData.weight.map(w => w.Weight));
            const totalLoss = (maxWeight - currentWeight).toFixed(1);

            document.getElementById('currentWeight').textContent = currentWeight + ' lbs';
            document.getElementById('totalWeightLoss').textContent = totalLoss;
        }

        function updateBirthdayStats() {
            const now = new Date();
            const startOfWeek = new Date(now.setDate(now.getDate() - now.getDay() + 1));
            const endOfWeek = new Date(startOfWeek);
            endOfWeek.setDate(endOfWeek.getDate() + 6);

            const thisWeekBirthdays = appData.birthdays.filter(birthday => {
                const birthDate = new Date(birthday.Date);
                const thisYearBirthday = new Date(now.getFullYear(), birthDate.getMonth(), birthDate.getDate());
                return thisYearBirthday >= startOfWeek && thisYearBirthday <= endOfWeek;
            }).length;

            const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);
            const endOfMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0);

            const thisMonthBirthdays = appData.birthdays.filter(birthday => {
                const birthDate = new Date(birthday.Date);
                const thisYearBirthday = new Date(now.getFullYear(), birthDate.getMonth(), birthDate.getDate());
                return thisYearBirthday >= startOfMonth && thisYearBirthday <= endOfMonth;
            }).length;

            document.getElementById('weeklyBirthdays').textContent = thisWeekBirthdays;
            document.getElementById('monthlyBirthdays').textContent = thisMonthBirthdays;
        }

        // Chart Functions
        function showChart(chartType) {
            // Update tab buttons
            document.querySelectorAll('.chart-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Update chart containers
            document.querySelectorAll('.chart-container').forEach(container => {
                container.classList.remove('active-chart');
            });
            document.getElementById(`${chartType}ChartContainer`).classList.add('active-chart');

            currentChart = chartType;

            // Load appropriate chart
            setTimeout(() => {
                if (chartType === 'weight') {
                    updateWeightChart();
                } else if (chartType === 'workouts') {
                    updateWorkoutChart();
                } else if (chartType === 'trends') {
                    updateTrendsChart();
                }
            }, 100);
        }

        function updateInsights() {
            updateInsightsStats();
            setTimeout(() => {
                updateWeightChart();
                updateWorkoutChart();
                updateTrendsChart();
            }, 100);
        }

        function updateInsightsStats() {
            // Current weight
            if (appData.weight.length > 0) {
                const sortedWeights = appData.weight.sort((a, b) => new Date(b.Date) - new Date(a.Date));
                const currentWeight = sortedWeights[0].Weight;
                const firstWeight = appData.weight.sort((a, b) => new Date(a.Date) - new Date(b.Date))[0].Weight;
                const weightChange = currentWeight - firstWeight;
                
                document.getElementById('insightCurrentWeight').textContent = currentWeight + ' lbs';
                document.getElementById('weightTrendText').textContent = 
                    weightChange < 0 ? `▼ ${Math.abs(weightChange).toFixed(1)} lbs lost` : 
                    weightChange > 0 ? `▲ ${weightChange.toFixed(1)} lbs gained` : 'No change';
            }

            // Total workouts
            document.getElementById('insightTotalWorkouts').textContent = appData.workouts.length;
            
            // Weekly average
            if (appData.workouts.length > 0) {
                const sortedWorkouts = appData.workouts.sort((a, b) => new Date(a.Date) - new Date(b.Date));
                const firstDate = new Date(sortedWorkouts[0].Date);
                const lastDate = new Date(sortedWorkouts[sortedWorkouts.length - 1].Date);
                const daysDiff = (lastDate - firstDate) / (1000 * 60 * 60 * 24);
                const weeks = Math.max(1, daysDiff / 7);
                const weeklyAvg = (appData.workouts.length / weeks).toFixed(1);
                
                document.getElementById('insightWeeklyAvg').textContent = weeklyAvg;
            }

            // Favorite workout type
            if (appData.workouts.length > 0) {
                const workoutTypes = {};
                appData.workouts.forEach(w => {
                    workoutTypes[w.Type] = (workoutTypes[w.Type] || 0) + 1;
                });
                
                const favoriteType = Object.keys(workoutTypes).reduce((a, b) => 
                    workoutTypes[a] > workoutTypes[b] ? a : b
                );
                
                document.getElementById('insightFavoriteType').textContent = favoriteType;
                document.getElementById('favoriteTypeCount').textContent = `${workoutTypes[favoriteType]} times`;
            }
        }

        function updateWeightChart() {
            const ctx = document.getElementById('weightChart');
            if (!ctx || appData.weight.length === 0) return;

            if (weightChart) {
                weightChart.destroy();
            }

            // Filter data based on current period
            let filteredWeights = appData.weight;
            if (currentWeightPeriod !== 'all') {
                const cutoffDate = new Date();
                cutoffDate.setDate(cutoffDate.getDate() - currentWeightPeriod);
                filteredWeights = appData.weight.filter(w => new Date(w.Date) >= cutoffDate);
            }

            const sortedWeights = filteredWeights.sort((a, b) => new Date(a.Date) - new Date(b.Date));
            
            weightChart = new Chart(ctx.getContext('2d'), {
                type: 'line',
                data: {
                    labels: sortedWeights.map(w => new Date(w.Date).toLocaleDateString()),
                    datasets: [{
                        label: 'Weight (lbs)',
                        data: sortedWeights.map(w => w.Weight),
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#667eea',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            callbacks: {
                                afterBody: (context) => {
                                    const dataIndex = context[0].dataIndex;
                                    const weight = sortedWeights[dataIndex];
                                    return weight.Notes ? [`Notes: ${weight.Notes}`] : [];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: { display: false },
                            ticks: { maxTicksLimit: 8 }
                        },
                        y: {
                            beginAtZero: false,
                            grid: { color: 'rgba(0, 0, 0, 0.1)' }
                        }
                    }
                }
            });
        }

        function updateWorkoutChart() {
            const ctx = document.getElementById('workoutChart');
            if (!ctx || appData.workouts.length === 0) return;

            if (workoutChart) {
                workoutChart.destroy();
            }

            if (currentWorkoutView === 'types') {
                // Workout types distribution
                const workoutTypes = {};
                appData.workouts.forEach(workout => {
                    workoutTypes[workout.Type] = (workoutTypes[workout.Type] || 0) + 1;
                });

                workoutChart = new Chart(ctx.getContext('2d'), {
                    type: 'doughnut',
                    data: {
                        labels: Object.keys(workoutTypes),
                        datasets: [{
                            data: Object.values(workoutTypes),
                            backgroundColor: [
                                '#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe', '#00f2fe'
                            ],
                            borderWidth: 3,
                            borderColor: '#fff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: { padding: 20, usePointStyle: true }
                            }
                        }
                    }
                });
            } else if (currentWorkoutView === 'frequency') {
                // Weekly workout frequency
                const weeklyData = {};
                appData.workouts.forEach(workout => {
                    const date = new Date(workout.Date);
                    const weekStart = new Date(date.setDate(date.getDate() - date.getDay()));
                    const weekKey = weekStart.toISOString().split('T')[0];
                    weeklyData[weekKey] = (weeklyData[weekKey] || 0) + 1;
                });

                const sortedWeeks = Object.keys(weeklyData).sort().slice(-8);

                workoutChart = new Chart(ctx.getContext('2d'), {
                    type: 'bar',
                    data: {
                        labels: sortedWeeks.map(week => `Week of ${new Date(week).toLocaleDateString()}`),
                        datasets: [{
                            label: 'Workouts',
                            data: sortedWeeks.map(week => weeklyData[week] || 0),
                            backgroundColor: 'rgba(102, 126, 234, 0.8)',
                            borderColor: '#667eea',
                            borderWidth: 2,
                            borderRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            x: { grid: { display: false } },
                            y: { beginAtZero: true, ticks: { stepSize: 1 } }
                        }
                    }
                });
            }
        }

        function updateTrendsChart() {
            const ctx = document.getElementById('trendsChart');
            if (!ctx) return;

            if (window.trendsChart) {
                window.trendsChart.destroy();
            }

            // Create a combined trends chart showing workout frequency and weight changes
            const last12Weeks = [];
            const now = new Date();
            for (let i = 11; i >= 0; i--) {
                const weekStart = new Date(now);
                weekStart.setDate(weekStart.getDate() - (i * 7) - weekStart.getDay());
                last12Weeks.push(weekStart);
            }

            const workoutData = last12Weeks.map(weekStart => {
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekEnd.getDate() + 6);
                return appData.workouts.filter(w => {
                    const workoutDate = new Date(w.Date);
                    return workoutDate >= weekStart && workoutDate <= weekEnd;
                }).length;
            });

            window.trendsChart = new Chart(ctx.getContext('2d'), {
                type: 'line',
                data: {
                    labels: last12Weeks.map(date => date.toLocaleDateString()),
                    datasets: [{
                        label: 'Weekly Workouts',
                        data: workoutData,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#667eea',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: { grid: { display: false } },
                        y: { beginAtZero: true, ticks: { stepSize: 1 } }
                    }
                }
            });
        }

        function filterWeightChart(days) {
            // Update button states
            document.querySelectorAll('#weightChartContainer .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            currentWeightPeriod = days;
            updateWeightChart();
        }

        function showWorkoutChart(viewType) {
            // Update button states
            document.querySelectorAll('#workoutChartContainer .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            currentWorkoutView = viewType;
            updateWorkoutChart();
        }

        function showTrendsChart(viewType) {
            // Update button states
            document.querySelectorAll('#trendsChartContainer .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            currentTrendsView = viewType;
            updateTrendsChart();
        }

        // Detail Modal Functions
        function loadWorkoutDetails() {
            const tbody = document.getElementById('workoutDetailBody');
            tbody.innerHTML = '';

            // Get last 14 workouts
            const recentWorkouts = appData.workouts
                .sort((a, b) => new Date(b.Date) - new Date(a.Date))
                .slice(0, 14);

            recentWorkouts.forEach(workout => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${new Date(workout.Date).toLocaleDateString()}</td>
                    <td>${workout.Type}</td>
                    <td>${workout.Duration || '-'}</td>
                    <td>${workout.Distance || '-'}</td>
                    <td>${workout['HR Zone'] || '-'}</td>
                    <td>${workout.Notes || '-'}</td>
                `;
            });
        }

        function loadWeightDetails() {
            filterModalWeightChart(30); // Default to 30 days
        }

        function loadBirthdayDetails() {
            const container = document.getElementById('birthdayDetailContent');
            const now = new Date();
            const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);
            const endOfMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0);

            const thisMonthBirthdays = appData.birthdays.filter(birthday => {
                const birthDate = new Date(birthday.Date);
                const thisYearBirthday = new Date(now.getFullYear(), birthDate.getMonth(), birthDate.getDate());
                return thisYearBirthday >= startOfMonth && thisYearBirthday <= endOfMonth;
            });

            if (thisMonthBirthdays.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666;">No birthdays this month</p>';
                return;
            }

            container.innerHTML = thisMonthBirthdays.map(birthday => {
                const birthDate = new Date(birthday.Date);
                const thisYearBirthday = new Date(now.getFullYear(), birthDate.getMonth(), birthDate.getDate());
                return `
                    <div style="padding: 1rem; margin-bottom: 1rem; background: #f8f9fa; border-radius: 10px;">
                        <h4>${birthday.Name}</h4>
                        <p><strong>Date:</strong> ${thisYearBirthday.toLocaleDateString()}</p>
                        ${birthday.Age ? `<p><strong>Age:</strong> ${birthday.Age}</p>` : ''}
                        ${birthday.Notes ? `<p><strong>Notes:</strong> ${birthday.Notes}</p>` : ''}
                    </div>
                `;
            }).join('');
        }

        function filterModalWeightChart(days) {
            // Update button states
            document.querySelectorAll('#weightDetailModal .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            const ctx = document.getElementById('modalWeightChart');
            if (!ctx || appData.weight.length === 0) return;

            if (modalWeightChart) {
                modalWeightChart.destroy();
            }

            // Filter data
            let filteredWeights = appData.weight;
            if (days !== 'all') {
                const cutoffDate = new Date();
                cutoffDate.setDate(cutoffDate.getDate() - days);
                filteredWeights = appData.weight.filter(w => new Date(w.Date) >= cutoffDate);
            }

            const sortedWeights = filteredWeights.sort((a, b) => new Date(a.Date) - new Date(b.Date));
            
            modalWeightChart = new Chart(ctx.getContext('2d'), {
                type: 'line',
                data: {
                    labels: sortedWeights.map(w => new Date(w.Date).toLocaleDateString()),
                    datasets: [{
                        label: 'Weight (lbs)',
                        data: sortedWeights.map(w => w.Weight),
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: `Weight Progress - Last ${days === 'all' ? 'All Time' : days + ' Days'}`
                        }
                    }
                }
            });
        }

        // Enhanced ChatGPT Integration
        function askChatGPT() {
            const question = document.getElementById('chatInput').value.trim();
            if (!question) return;

            const sendBtn = document.getElementById('chatSendBtn');
            const input = document.getElementById('chatInput');
            
            // Disable input while processing
            sendBtn.disabled = true;
            input.disabled = true;

            // Add user message to chat
            addChatMessage(question, 'user');

            // Add typing indicator
            addTypingIndicator();

            // Prepare data context if enabled
            const includeData = document.getElementById('includePersonalData').checked;
            let dataContext = '';
            
            if (includeData) {
                dataContext = generateDataSummary();
            }

            // Call ChatGPT API (you'll need to implement this with your API key)
            callChatGPTAPI(question, dataContext)
                .then(response => {
                    removeTypingIndicator();
                    addChatMessage(response, 'ai');
                })
                .catch(error => {
                    removeTypingIndicator();
                    addChatMessage('Sorry, I encountered an error. Please try again.', 'ai');
                    console.error('ChatGPT API Error:', error);
                })
                .finally(() => {
                    sendBtn.disabled = false;
                    input.disabled = false;
                    input.value = '';
                });
        }

        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                askChatGPT();
            }
        }

        function askSuggestion(question) {
            document.getElementById('chatInput').value = question;
            askChatGPT();
        }

        function addChatMessage(message, type) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${type}-message`;
            
            const avatar = type === 'ai' ? 'fas fa-robot' : 'fas fa-user';
            
            messageDiv.innerHTML = `
                <div class="message-avatar">
                    <i class="${avatar}"></i>
                </div>
                <div class="message-content">
                    <p>${message}</p>
                </div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function addTypingIndicator() {
            const messagesContainer = document.getElementById('chatMessages');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'chat-message ai-message typing-indicator';
            typingDiv.id = 'typingIndicator';
            
            typingDiv.innerHTML = `
                <div class="message-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="message-content">
                    <div class="typing-indicator">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            `;
            
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        function generateDataSummary() {
            let summary = "Here's the user's fitness data:\n\n";
            
            // Workout summary
            if (appData.workouts.length > 0) {
                const workoutTypes = {};
                appData.workouts.forEach(w => {
                    workoutTypes[w.Type] = (workoutTypes[w.Type] || 0) + 1;
                });
                
                summary += `Workouts: ${appData.workouts.length} total workouts logged.\n`;
                summary += `Workout types: ${Object.entries(workoutTypes).map(([type, count]) => `${type} (${count})`).join(', ')}\n`;
                
                // Recent workouts
                const recentWorkouts = appData.workouts
                    .sort((a, b) => new Date(b.Date) - new Date(a.Date))
                    .slice(0, 5);
                summary += `Recent workouts: ${recentWorkouts.map(w => `${w.Type} on ${w.Date}`).join(', ')}\n\n`;
            }
            
            // Weight summary
            if (appData.weight.length > 0) {
                const sortedWeights = appData.weight.sort((a, b) => new Date(a.Date) - new Date(b.Date));
                const currentWeight = sortedWeights[sortedWeights.length - 1].Weight;
                const startWeight = sortedWeights[0].Weight;
                const weightChange = currentWeight - startWeight;
                
                summary += `Weight: Current weight is ${currentWeight} lbs.\n`;
                summary += `Weight change: ${weightChange > 0 ? 'Gained' : 'Lost'} ${Math.abs(weightChange).toFixed(1)} lbs since tracking started.\n`;
                summary += `Weight entries: ${appData.weight.length} total entries.\n\n`;
            }
            
            return summary;
        }

        // ChatGPT API Call (replace with your implementation)
        async function callChatGPTAPI(question, dataContext) {
            // IMPORTANT: Replace this with your actual ChatGPT API implementation
            // This is a placeholder that simulates an API call
            
            // Uncomment and modify this section when you have your API key:
            /*
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Authorization': 'Bearer YOUR_API_KEY_HERE',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    model: 'gpt-3.5-turbo',
                    messages: [
                        {
                            role: 'system',
                            content: 'You are a helpful fitness coach analyzing personal workout and weight data.'
                        },
                        {
                            role: 'user',
                            content: dataContext ? `${dataContext}\n\nQuestion: ${question}` : question
                        }
                    ]
                })
            });
            
            const data = await response.json();
            return data.choices[0].message.content;
            */

            // Simulate API delay
            await new Promise(resolve => setTimeout(resolve, 2000));

            // Return a simulated response (replace this with actual API call)
            return generateSimulatedResponse(question, dataContext);
        }

        function generateSimulatedResponse(question, dataContext) {
            // This is a placeholder response generator
            // Replace this entire function with actual ChatGPT API integration
            
            const responses = [
                "Based on your data, you're making great progress! Your consistency with workouts is impressive.",
                "I can see you've been tracking your fitness journey well. Consider focusing on variety in your workout types.",
                "Your weight tracking shows good awareness. Remember that progress isn't just about the number on the scale.",
                "Looking at your workout patterns, you might benefit from setting specific weekly goals.",
                "Your data shows dedication to fitness. Keep up the great work and stay consistent!"
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        // Settings Functions
        function exportData() {
            const dataType = document.getElementById('exportDataType').value;
            const format = document.getElementById('exportFormat').value;
            
            if (appData[dataType].length === 0) {
                showNotification('No data to export', 'error');
                return;
            }

            const data = appData[dataType];
            let content, filename;

            if (format === 'csv') {
                content = Papa.unparse(data);
                filename = `${dataType}_${new Date().toISOString().split('T')[0]}.csv`;
                downloadFile(content, filename, 'text/csv');
            } else {
                // For Excel format, we'll use CSV for now (you can add a proper Excel library later)
                content = Papa.unparse(data);
                filename = `${dataType}_${new Date().toISOString().split('T')[0]}.csv`;
                downloadFile(content, filename, 'text/csv');
            }

            showNotification(`${dataType} data exported successfully!`);
        }

        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function saveNotificationSettings() {
            const emailEnabled = document.getElementById('emailNotifications').checked;
            const email = document.getElementById('notificationEmail').value;
            
            // Save settings (in a real app, this would save to backend)
            localStorage.setItem('notificationSettings', JSON.stringify({
                emailEnabled,
                email
            }));
            
            showNotification('Notification settings saved!');
        }

        function importCSV(event, dataType) {
            const file = event.target.files[0];
            if (!file) return;

            Papa.parse(file, {
                header: true,
                dynamicTyping: true,
                skipEmptyLines: true,
                complete: function(results) {
                    if (results.errors.length > 0) {
                        showNotification('Error parsing CSV', 'error');
                        return;
                    }

                    // Add IDs to imported data
                    const importedData = results.data.map(row => ({
                        ...row,
                        id: Date.now() + Math.random()
                    }));

                    // Merge with existing data
                    appData[dataType] = appData[dataType].concat(importedData);
                    
                    updateDashboard();
                    updateInsights();
                    showNotification(`Imported ${importedData.length} ${dataType} records!`);
                }
            });

            event.target.value = ''; // Reset input
        }

        // Notification System
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const icon = type === 'error' ? 'fas fa-exclamation-circle' : 
                         type === 'warning' ? 'fas fa-exclamation-triangle' : 
                         'fas fa-check-circle';
            
            notification.innerHTML = `<i class="${icon}"></i><span>${message}</span>`;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Sample Data (remove this when you import your real data)
        function loadSampleData() {
            // Sample workout data
            appData.workouts = [
                {
                    id: 1,
                    Date: '2024-01-15',
                    Type: 'run',
                    Duration: '',
                    Distance: 3.2,
                    'HR Zone': null,
                    Notes: 'Morning run, felt great'
                },
                {
                    id: 2,
                    Date: '2024-01-16',
                    Type: 'lift',
                    Duration: '',
                    Distance: null,
                    'HR Zone': null,
                    Notes: 'Muscle Groups: chest, biceps, shoulders'
                }
            ];

            // Sample weight data
            appData.weight = [
                {
                    id: 1,
                    Date: '2024-01-15',
                    Weight: 175.5,
                    'Body Fat %': 15.2,
                    Notes: 'Morning weight'
                },
                {
                    id: 2,
                    Date: '2024-01-20',
                    Weight: 174.8,
                    'Body Fat %': 15.1,
                    Notes: 'After workout week'
                }
            ];

            // Sample birthday data
            appData.birthdays = [
                {
                    id: 1,
                    Name: 'John Smith',
                    Date: '1985-06-15',
                    Age: 38,
                    Notes: 'College friend, likes tech gadgets'
                }
            ];
        }
    </script>
</body>
</html>
                <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Fitness Assistant</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        /* Navigation */
        .nav-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav {
            display: flex;
            justify-content: center;
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 50px;
            padding: 8px;
        }

        .nav-item {
            flex: 1;
            text-align: center;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-item.active {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Quick Actions Section */
        .quick-actions {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .quick-actions h2 {
            margin-bottom: 1.5rem;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .action-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 1.5rem;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1rem;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .action-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .action-btn i {
            font-size: 1.5rem;
        }

        /* Summary Cards */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .summary-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.15);
        }

        .summary-card h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1rem;
            color: #333;
        }

        .summary-card .stat {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        .summary-card .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            animation: modalFadeIn 0.3s ease;
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
            transition: color 0.3s ease;
        }

        .close-btn:hover {
            color: #333;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
        }

        /* Button Styles */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #e1e5e9;
        }

        .btn-secondary:hover {
            background: #e9ecef;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }

        /* Chart Tabs */
        .chart-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 8px;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }

        .chart-tab {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .chart-tab:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .chart-tab.active {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        /* Chart Containers */
        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            display: none;
        }

        .chart-container.active-chart {
            display: block;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .chart-header h3 {
            color: #333;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
            width: 100%;
        }

        .chart-wrapper canvas {
            max-height: 100%;
            width: 100% !important;
        }

        /* Improved Chart Filters */
        .chart-filters {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 16px;
            border: 2px solid #e1e5e9;
            background: white;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
            color: #666;
        }

        .filter-btn:hover {
            border-color: #667eea;
            color: #667eea;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        /* Enhanced ChatGPT Styles */
        .chatgpt-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 0;
            margin-top: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }

        .chat-header h3 {
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .chat-header p {
            opacity: 0.9;
            margin: 0;
        }

        .chat-messages {
            max-height: 400px;
            overflow-y: auto;
            padding: 1rem;
            background: #f8f9fa;
        }

        .chat-message {
            display: flex;
            gap: 12px;
            margin-bottom: 1.5rem;
            animation: messageSlideIn 0.3s ease;
        }

        @keyframes messageSlideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .ai-message .message-avatar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .user-message .message-avatar {
            background: #e9ecef;
            color: #666;
        }

        .message-content {
            flex: 1;
            background: white;
            padding: 1rem 1.5rem;
            border-radius: 18px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .user-message .message-content {
            background: #667eea;
            color: white;
        }

        .suggestion-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 1rem;
        }

        .suggestion-chip {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 20px;
            padding: 8px 12px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .suggestion-chip:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .chat-input-container {
            padding: 1.5rem;
            background: white;
            border-top: 1px solid #e9ecef;
        }

        .chat-input {
            display: flex;
            gap: 12px;
            margin-bottom: 1rem;
        }

        .chat-input input {
            flex: 1;
            padding: 12px 18px;
            border: 2px solid #e1e5e9;
            border-radius: 25px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .chat-input input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .chat-input button {
            width: 48px;
            height: 48px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chat-input button:hover {
            background: #5a6fd8;
            transform: scale(1.05);
        }

        .chat-input button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .chat-settings {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: #666;
        }

        .chat-settings input[type="checkbox"] {
            width: auto;
        }

        /* Loading indicator for chat */
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 1rem;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #667eea;
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* Insights Stats Improvements */
        .insights-stats .stats-grid {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .stat-value {
            font-size: 2.2em;
            font-weight: bold;
            margin-bottom: 8px;
            line-height: 1;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
            font-weight: 500;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 350px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: #dc3545;
        }

        .notification.warning {
            background: #ffc107;
            color: #333;
        }

        /* Settings Styles */
        .settings-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        .export-controls {
            display: flex;
            gap: 15px;
            align-items: end;
            flex-wrap: wrap;
        }

        .export-controls .form-group {
            margin-bottom: 0;
            min-width: 150px;
        }

        /* Data Table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e1e5e9;
        }

        .data-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #555;
        }

        .data-table tbody tr:hover {
            background: #f8f9fa;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .nav {
                margin: 0 1rem;
            }

            .nav-item {
                padding: 10px;
                font-size: 0.9rem;
            }

            .nav-item span {
                display: none;
            }

            .action-buttons {
                grid-template-columns: 1fr;
            }

            .summary-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                padding: 1.5rem;
            }

            .chart-header {
                flex-direction: column;
                align-items: stretch;
            }

            .chart-filters {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <div class="nav-container">
        <div class="nav">
            <div class="nav-item active" onclick="showTab('dashboard')">
                <i class="fas fa-home"></i>
                <span>Dashboard</span>
            </div>
            <div class="nav-item" onclick="showTab('insights')">
                <i class="fas fa-chart-line"></i>
                <span>Insights</span>
            </div>
            <div class="nav-item" onclick="showTab('settings')">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <!-- Quick Actions -->
            <div class="quick-actions">
                <h2><i class="fas fa-bolt"></i> Quick Actions</h2>
                <div class="action-buttons">
                    <button class="action-btn" onclick="openModal('workoutModal')">
                        <i class="fas fa-dumbbell"></i>
                        Log Workout
                    </button>
                    <button class="action-btn" onclick="openModal('weightModal')">
                        <i class="fas fa-weight"></i>
                        Log Weight
                    </button>
                    <button class="action-btn" onclick="openModal('birthdayModal')">
                        <i class="fas fa-birthday-cake"></i>
                        Add Birthday
                    </button>
                </div>
            </div>

            <!-- Summary Cards -->
            <div class="summary-grid">
                <div class="summary-card" onclick="openModal('workoutDetailModal')">
                    <h3><i class="fas fa-dumbbell"></i> Workouts</h3>
                    <div class="stat" id="weeklyWorkouts">-</div>
                    <div class="stat-label">This Week</div>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        Avg: <span id="avgWorkouts">-</span>/week | 
                        <span id="workoutTrend">-</span> vs last week
                    </div>
                </div>

                <div class="summary-card" onclick="openModal('weightDetailModal')">
                    <h3><i class="fas fa-weight"></i> Weight</h3>
                    <div class="stat" id="currentWeight">-</div>
                    <div class="stat-label">Current Weight</div>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        Lost: <span id="totalWeightLoss">-</span> lbs total
                    </div>
                </div>

                <div class="summary-card" onclick="openModal('birthdayDetailModal')">
                    <h3><i class="fas fa-birthday-cake"></i> Birthdays</h3>
                    <div class="stat" id="weeklyBirthdays">-</div>
                    <div class="stat-label">This Week</div>
                    <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        This Month: <span id="monthlyBirthdays">-</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Insights Tab -->
        <div id="insights" class="tab-content">
            <!-- Stats Overview -->
            <div class="insights-stats">
                <div class="stats-grid" style="margin-bottom: 2rem;">
                    <div class="stat-card">
                        <div class="stat-value" id="insightCurrentWeight">-</div>
                        <div class="stat-label">Current Weight</div>
                        <div style="font-size: 0.8rem; margin-top: 5px; opacity: 0.9;" id="weightTrendText">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="insightTotalWorkouts">-</div>
                        <div class="stat-label">Total Workouts</div>
                        <div style="font-size: 0.8rem; margin-top: 5px; opacity: 0.9;" id="workoutStreakText">-</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="insightWeeklyAvg">-</div>
                        <div class="stat-label">Weekly Average</div>
                        <div style="font-size: 0.8rem; margin-top: 5px; opacity: 0.9;">workouts per week</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="insightFavoriteType">-</div>
                        <div class="stat-label">Favorite Workout</div>
                        <div style="font-size: 0.8rem; margin-top: 5px; opacity: 0.9;" id="favoriteTypeCount">-</div>
                    </div>
                </div>
            </div>

            <!-- Chart Selection Tabs -->
            <div class="chart-tabs">
                <button class="chart-tab active" onclick="showChart('weight')">
                    <i class="fas fa-weight"></i> Weight Progress
                </button>
                <button class="chart-tab" onclick="showChart('workouts')">
                    <i class="fas fa-dumbbell"></i> Workout Analysis
                </button>
                <button class="chart-tab" onclick="showChart('trends')">
                    <i class="fas fa-chart-line"></i> Weekly Trends
                </button>
            </div>

            <!-- Weight Chart Container -->
            <div id="weightChartContainer" class="chart-container active-chart">
                <div class="chart-header">
                    <h3><i class="fas fa-weight"></i> Weight Progress</h3>
                    <div class="chart-filters">
                        <button class="filter-btn active" onclick="filterWeightChart(7)" data-period="7">7 Days</button>
                        <button class="filter-btn" onclick="filterWeightChart(14)" data-period="14">14 Days</button>
                        <button class="filter-btn" onclick="filterWeightChart(30)" data-period="30">30 Days</button>
                        <button class="filter-btn" onclick="filterWeightChart(